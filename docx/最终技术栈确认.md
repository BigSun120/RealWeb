# 最终技术栈确认

## 一、技术栈总览

### 🎯 确定的技术选型
基于您的要求，最终确定的技术栈如下：

| 分类 | 技术选择 | 说明 |
|------|----------|------|
| **前端框架** | Vue 3 + Vite | 现代化前端开发 |
| **UI组件库** | Element Plus | 丰富的组件生态 |
| **状态管理** | Pinia | Vue 3官方推荐 |
| **后端框架** | Node.js + Express | 轻量级Web框架 |
| **数据库** | MongoDB | 文档型数据库 |
| **缓存方案** | node-cache | 内存缓存，无需Redis |
| **认证方案** | JWT | 无状态认证 |
| **部署方式** | 直接部署 | 无Docker，简化部署 |
| **进程管理** | PM2（可选） | 生产环境推荐 |
| **监控方案** | 无 | 去除复杂监控系统 |

## 二、架构简化对比

### 📊 简化前后对比

| 组件 | 原方案 | 最终方案 | 简化效果 |
|------|--------|----------|----------|
| **数据存储** | MongoDB + Redis | MongoDB + 内存缓存 | ✅ 减少1个服务 |
| **部署方式** | Docker + Nginx + PM2 | 直接部署 + PM2 | ✅ 大幅简化 |
| **监控系统** | Prometheus + Grafana + ELK | 基础日志 | ✅ 完全移除 |
| **配置文件** | 15+ 个配置文件 | 6个核心配置 | ✅ 减少60% |
| **学习成本** | 高 | 低 | ✅ 适合个人项目 |

## 三、项目结构

### 📁 最终项目结构
```
personal-website/
├── frontend/                 # Vue3前端项目
│   ├── src/
│   │   ├── components/       # 公共组件
│   │   ├── views/           # 页面组件
│   │   ├── stores/          # Pinia状态管理
│   │   ├── router/          # 路由配置
│   │   └── api/             # API请求封装
│   ├── public/
│   └── package.json
├── backend/                  # Node.js后端项目
│   ├── src/
│   │   ├── controllers/     # 控制器
│   │   ├── models/          # 数据模型
│   │   ├── routes/          # 路由定义
│   │   ├── middleware/      # 中间件
│   │   └── utils/           # 工具函数
│   ├── uploads/             # 文件上传目录
│   ├── logs/                # 日志目录
│   └── package.json
├── docs/                    # 项目文档
├── rules/                   # 配置文件和规范
│   ├── .eslintrc.js
│   ├── .prettierrc.js
│   ├── .gitignore
│   ├── .env.example
│   └── deploy.sh
├── .env                     # 环境变量（需创建）
└── package.json             # 根目录脚本
```

## 四、核心依赖

### 🔧 前端依赖
```json
{
  "dependencies": {
    "vue": "^3.3.0",
    "vue-router": "^4.2.0",
    "pinia": "^2.1.0",
    "element-plus": "^2.3.0",
    "axios": "^1.4.0"
  },
  "devDependencies": {
    "vite": "^4.3.0",
    "@vitejs/plugin-vue": "^4.2.0",
    "sass": "^1.62.0"
  }
}
```

### ⚙️ 后端依赖
```json
{
  "dependencies": {
    "express": "^4.18.0",
    "mongoose": "^7.3.0",
    "jsonwebtoken": "^9.0.0",
    "bcryptjs": "^2.4.3",
    "node-cache": "^5.1.2",
    "multer": "^1.4.5",
    "cors": "^2.8.5",
    "helmet": "^7.0.0",
    "express-rate-limit": "^6.7.0",
    "winston": "^3.9.0"
  },
  "devDependencies": {
    "nodemon": "^2.0.22",
    "jest": "^29.5.0"
  }
}
```

## 五、环境配置

### 🌍 环境变量配置
```bash
# .env 文件配置
NODE_ENV=development
PORT=8000
MONGODB_URI=mongodb://localhost:27017/personal_website_dev
JWT_SECRET=your_super_secret_jwt_key_here
UPLOAD_PATH=./uploads
FRONTEND_URL=http://localhost:3000
```

### 🚀 快速启动命令
```bash
# 开发环境
npm run dev          # 同时启动前后端开发服务器

# 生产部署
npm run setup        # 安装所有依赖
npm run build        # 构建前端
npm start           # 启动生产服务器

# 或使用一键部署脚本
chmod +x rules/deploy.sh
./rules/deploy.sh
```

## 六、数据库设计

### 🗄️ MongoDB集合设计
```javascript
// 用户集合
users: {
  _id: ObjectId,
  username: String,
  email: String,
  password: String,    // bcrypt加密
  avatar: String,
  bio: String,
  role: String,        // 'admin' | 'user'
  createdAt: Date,
  updatedAt: Date
}

// 文章集合
articles: {
  _id: ObjectId,
  title: String,
  content: String,     // Markdown格式
  authorId: ObjectId,  // 关联users
  category: String,
  tags: [String],
  coverImage: String,
  viewCount: Number,
  likeCount: Number,
  status: String,      // 'published' | 'draft'
  createdAt: Date,
  updatedAt: Date
}

// 评论集合
comments: {
  _id: ObjectId,
  articleId: ObjectId, // 关联articles
  userId: ObjectId,    // 关联users
  content: String,
  parentId: ObjectId,  // 回复功能
  createdAt: Date
}

// 游戏集合
games: {
  _id: ObjectId,
  name: String,
  description: String,
  category: String,
  thumbnail: String,
  url: String,
  playCount: Number,
  createdAt: Date
}

// 游戏分数集合
gameScores: {
  _id: ObjectId,
  gameId: ObjectId,    // 关联games
  userId: ObjectId,    // 关联users
  score: Number,
  createdAt: Date
}
```

## 七、缓存策略

### 💾 内存缓存使用
```javascript
const NodeCache = require('node-cache');

// 缓存实例
const cache = new NodeCache({ 
  stdTTL: 600,        // 默认10分钟
  checkperiod: 120    // 每2分钟检查过期
});

// 缓存使用示例
// 热门文章缓存1小时
cache.set('articles:hot', hotArticles, 3600);

// 文章列表缓存10分钟
cache.set(`articles:page:${page}`, articles, 600);

// 游戏排行榜缓存5分钟
cache.set(`game:${gameId}:ranking`, rankings, 300);
```

## 八、安全措施

### 🔒 基础安全配置
```javascript
// 安全中间件
app.use(helmet());                    // 安全头
app.use(cors({ origin: process.env.FRONTEND_URL })); // CORS
app.use(rateLimit({                   // 基础限流
  windowMs: 15 * 60 * 1000,
  max: 100
}));

// JWT认证
const jwt = require('jsonwebtoken');
const token = jwt.sign({ userId }, process.env.JWT_SECRET, { expiresIn: '24h' });

// 密码加密
const bcrypt = require('bcryptjs');
const hashedPassword = await bcrypt.hash(password, 12);
```

## 九、部署方案

### 🚀 生产环境部署
```bash
# 1. 服务器准备
# - 安装Node.js 16+
# - 安装MongoDB
# - 配置防火墙

# 2. 代码部署
git clone your-repository
cd personal-website
cp rules/.env.example .env
# 编辑.env文件配置生产环境参数

# 3. 安装依赖和构建
npm run setup
npm run build

# 4. 启动服务
# 方式1：直接运行
npm start

# 方式2：PM2管理（推荐）
npm install -g pm2
pm2 start backend/app.js --name website
pm2 startup
pm2 save
```

## 十、开发流程

### 👨‍💻 开发工作流
```bash
# 1. 开发环境启动
npm run dev

# 2. 代码提交
git add .
git commit -m "feat: 添加用户登录功能"
git push

# 3. 代码检查
npm run lint
npm run format

# 4. 测试
npm run test

# 5. 构建部署
npm run build
npm run deploy:pm2
```

## 十一、扩展计划

### 📈 未来扩展路径
当项目规模增长时，可以考虑以下扩展：

1. **缓存扩展**：内存缓存 → Redis
2. **数据库扩展**：单机MongoDB → MongoDB集群
3. **部署扩展**：直接部署 → Docker → Kubernetes
4. **监控扩展**：基础日志 → 完整监控系统
5. **CDN扩展**：本地静态文件 → CDN加速

## 十二、总结

### ✅ 技术栈优势
- **简单易用**：技术栈精简，学习成本低
- **快速开发**：Vue3 + Express组合开发效率高
- **易于部署**：无复杂依赖，部署简单
- **成本可控**：单服务器即可运行
- **可扩展**：后期可根据需要逐步扩展

### 🎯 适用场景
- 个人博客网站
- 小型内容管理系统
- 学习项目和原型开发
- 中小型企业官网

这个技术栈配置在保证功能完整性的同时，大幅降低了复杂度，非常适合个人开发者快速构建和部署网站项目。
